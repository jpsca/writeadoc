{# def folded: bool = False #}

{% macro render_icon(item) -%}
  {%- if item.icon -%}
    {% if item.icon.endswith('.svg') -%}
      {{ _insert_asset(item.icon) }}
    {%- else -%}
      <img src="/assets/{{ item.icon }}" />
    {%- endif -%}
  {%- endif -%}
{%- endmacro %}

{% macro render_pages(items) -%}
  {% for item in items -%}
  {%- if item.pages -%}
  <details class="toc__section" {% if not folded %}open{% endif %}>
    <summary>
      {{ render_icon(item) }} {{ item.title }}
    </summary>
    <div>{{ render_pages(item.pages) }}</div>
  </details>
  {%- else %}
    <a
      class="toc__page {% if item.id == page.id %}toc__page--selected{% endif %}"
      href="{{ item.url }}"
      aria-label="{{ item.title }}"
    >
      {{ render_icon(item) }} {{ item.title }}
    </a>
  {%- endif %}
  {% endfor %}

{% endmacro %}

<div class="toc">
  {{ render_pages(site.nav) }}
</div>
